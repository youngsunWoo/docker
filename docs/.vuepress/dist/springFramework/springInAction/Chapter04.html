<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter3# AOP | Sunny Archive</title>
    <meta name="description" content="개발 관련 블로그">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/sunny-archive/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons">
    
    <link rel="preload" href="/sunny-archive/assets/css/0.styles.a7ac78a8.css" as="style"><link rel="preload" href="/sunny-archive/assets/js/app.20f77d52.js" as="script"><link rel="preload" href="/sunny-archive/assets/js/2.511b4fc5.js" as="script"><link rel="preload" href="/sunny-archive/assets/js/22.085befa6.js" as="script"><link rel="prefetch" href="/sunny-archive/assets/js/10.a0ef1271.js"><link rel="prefetch" href="/sunny-archive/assets/js/11.6541ddd8.js"><link rel="prefetch" href="/sunny-archive/assets/js/12.1903e15c.js"><link rel="prefetch" href="/sunny-archive/assets/js/13.197863a7.js"><link rel="prefetch" href="/sunny-archive/assets/js/14.9b068972.js"><link rel="prefetch" href="/sunny-archive/assets/js/15.54027cd4.js"><link rel="prefetch" href="/sunny-archive/assets/js/16.524f5d92.js"><link rel="prefetch" href="/sunny-archive/assets/js/17.11708487.js"><link rel="prefetch" href="/sunny-archive/assets/js/18.5d867f86.js"><link rel="prefetch" href="/sunny-archive/assets/js/19.0f648627.js"><link rel="prefetch" href="/sunny-archive/assets/js/20.27ef1d38.js"><link rel="prefetch" href="/sunny-archive/assets/js/21.77345df6.js"><link rel="prefetch" href="/sunny-archive/assets/js/23.8490966f.js"><link rel="prefetch" href="/sunny-archive/assets/js/24.ec8405cd.js"><link rel="prefetch" href="/sunny-archive/assets/js/25.b0db359b.js"><link rel="prefetch" href="/sunny-archive/assets/js/26.46aa84cd.js"><link rel="prefetch" href="/sunny-archive/assets/js/27.8c499cc1.js"><link rel="prefetch" href="/sunny-archive/assets/js/28.a0f23262.js"><link rel="prefetch" href="/sunny-archive/assets/js/3.6c4817b1.js"><link rel="prefetch" href="/sunny-archive/assets/js/4.360058bb.js"><link rel="prefetch" href="/sunny-archive/assets/js/5.c75d34e9.js"><link rel="prefetch" href="/sunny-archive/assets/js/6.7ef6ecd2.js"><link rel="prefetch" href="/sunny-archive/assets/js/7.e7a5c462.js"><link rel="prefetch" href="/sunny-archive/assets/js/8.07adb725.js"><link rel="prefetch" href="/sunny-archive/assets/js/9.026c5ddc.js">
    <link rel="stylesheet" href="/sunny-archive/assets/css/0.styles.a7ac78a8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/sunny-archive/" class="home-link router-link-active"><!----> <span class="site-name">Sunny Archive</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/youngsunWoo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/youngsunWoo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/sunny-archive/" class="sidebar-heading clickable router-link-active open"><span>책읽기</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>JAVA</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>스프링 인 액션</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sunny-archive/springFramework/springInAction/Chapter01.html" class="sidebar-link">Chapter01# Spring속으로</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter02.html" class="sidebar-link">Chapter02# Spring BeanWiring</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter03.html" class="sidebar-link">Chapter03# 고급와이어링</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter04.html" class="active sidebar-link">Chapter04# AOP</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter05.html" class="sidebar-link">Chapter05# Spring Web Application</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter19.html" class="sidebar-link">Chapter19# 이메일전송하기</a></li><li><a href="/sunny-archive/springFramework/springInAction/Chapter20.html" class="sidebar-link">Chapter20# JXM을 이용한 스프링 빈 관리</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="chapter3-aop"><a href="#chapter3-aop" class="header-anchor">#</a> Chapter3# AOP</h1> <h3 id="_1-aop란"><a href="#_1-aop란" class="header-anchor">#</a> 1. AOP란</h3> <p><strong>용어정리</strong>
어드바이스 (Advice)<br>
Aspect의 기능 그 자체<br>
어드바이스는 애스펙트가 '무엇'을 '언제' 할지를 정의</p> <p>포인트컷 (PointCut)<br>
부가기능이 적용될 대상(메소드)를 선정하는 방법<br>
즉, 어드바이스를 적용할 조인포인트를 선별하는 기능을 정의한 모듈</p> <p>조인포인트 (JoinPoint)<br>
어드바이스가 적용될 수 있는 위치<br>
다른 AOP 프레임워크와 달리 Spring에서는 메소드 조인포인트만 제공한다.</p> <p>애스펙트 (Aspect)<br>
어드바이스 (Advice) + 포인트컷 (PointCut)</p> <p>인트로덕션(Introduction)<br>
기존 클래스의 코드변경 없이 새 메소드나 멤버변수를 추가할수 있는 기능</p> <p>위빙(Weaving)<br>
타깃에 애스팩드를 적용해서 프록시 객체를 생성하는 절차</p> <ul><li>Spring 의 AOP지원</li></ul> <ul><li>고정적인 스프링 프록시 기반 AOP</li> <li>Pure-POJO 애스팩트</li> <li>@AspectJ 애너테이션 기반</li> <li>AspectJ 에스팩트에 빈 주입</li></ul> <h3 id="_2-포인트컷트를-이용한-조인포인트-설정"><a href="#_2-포인트컷트를-이용한-조인포인트-설정" class="header-anchor">#</a> 2. 포인트컷트를 이용한 조인포인트 설정</h3> <p>포인트커트는 애스펙트의 어드바이스를 적용할 위치를 지정하는 데 사용한다<br>
AspectJ의 포인트커트 표현식 언어</p> <p><strong>2.1 포인트컷 작성</strong>
package consert;</p> <p>public interface Performance {
public void perform();
}
Performance는 공연을 나타낸다.
Performamce의 perform() 메소드를 트리거링(triggering)하는 애스펙트를 작성할 수 있다
perform() 메소드가 실행될 때마다 어드바이스를 하기 위해 사용될 수 있는 포인트커트 표현식을 나타낸다.</p> <p>execution(수식어패턴? 리턴타입패턴 패키지패턴?이름패턴(파라미터패턴)</p> <p><strong>2.2 빈 선택하기</strong>
지정자 목록 외에도 스프링은 새로운 bean() 지정자를 도입했는데, 이를 이용하여 포인트커트 표현식 내에서 ID로 빈을 지정할 수 있다.
bean()은 인자로 빈 ID나 이름을 받고 특정 빈에 대한 포인트커트의 영향을 제한한다.
execution(* consert.Performance.perform())
and bean('woodstock')
여기서 애스펙트 어드바이스를 Performance에 있는 perform() 메소드의 실행에 적용하되 ID가 woodstock인 빈으로 제한한다.</p> <p>특정 빈으로 포인트커트를 좁히는 경우의 작업도 있지만, 특정 ID가 아닌 모든 빈에 애스펙트를 적용하기 위해 부정(!)을 사용할 수도 있다.
execution(* consert.Performance.perform())
and !bean('woodstock’)
이 경우에 애스펙트의 어드바이스는 ID가 woodstock이 아닌 모든 빈에 위빙된다.</p> <h3 id="_3-애스팩트-에너테이션-만들기"><a href="#_3-애스팩트-에너테이션-만들기" class="header-anchor">#</a> 3. 애스팩트 에너테이션 만들기</h3> <p>**3.1 애스팩트 정의하기 **</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Audience</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** concert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">silenceCellPhones</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Silencing cell phones&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** consert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">takeSeats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Taking seats&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** consert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">applause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CLAP CLAP CLAP! ! !&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@AfterThrowing</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** consert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">demandRefund</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Demanding a refund&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Audience 클래스에는 @Aspect라는 애너테이션이 붙어 있다.<br>
이 애너테이션은 Audience가 더 이상 POJO가 아니라 애스펙트임을 나타낸다.<br>
Audience 클래스는 특정 애스펙트를 정의하기 위해 애터네이션되는 메서드이다.</p> <p>Audience클래스는 네 개의 메소드를 가진다.<br>
공연전에 핸드폰을 끈고(silenceCellPhones), 착성하고(takeSeat), 공연이 끝나면 박수(applause), 공연이 중단되면 환불(demandRefund) 하는 네 개의 메소드를 가진다.<br>
이러한 메소드들은 호출될 때를 기다리기 위해서 어드바이스 애너테이션을 사용하여 애너테이션된다.</p> <p>AspectJ의 어드바이스를 정의하기 위한 다섯 개의 애너테이션</p> <p>반복되는 포인트 컷의 정리 - @Pointcut 애너테이션을 사용하면 한 번만 포인트커트를 정의하고 필요할 때마다 참조</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Audience</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** concert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;performance()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">silenceCellPhones</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Silencing cell phones&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;performance()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">takeSeats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Taking seats&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span><span class="token string">&quot;performance()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">applause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CLAP CLAP CLAP! ! !&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@AfterThrowing</span><span class="token punctuation">(</span><span class="token string">&quot;performance()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">demandRefund</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Demanding a refund&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>**3.2  around 어드바이스 만들기 **
around 어드바이스는 가장 강력한 어드바이스 타입이다.<br>
어드바이스된 메소드를 완전히 감싸는 로직을 작성하며, 단일 어드바이스 메소드 내의 before 어드바이스와 after 어드바이스를 작성한다.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Audience</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(** concert.Performance.perform(..)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 
    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;performance()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">watchPerformance</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> jp<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Silencing cell phones&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Taking seats&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            jp<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CLAP CLAP CLAP! ! !&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Demanding a refund&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>어드바이스에서 파라미터 처리하기
포인트 커트 표현식의 파라미터 선언하기<br>
트랙 재생횟수를 카운트하기 위해 파라미터화된 어드바이스 사용</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TrackCounter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> trackCounts <span class="token operator">=</span> 
            <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;execution(* soundSystem.CD.playTrack(int))&quot;</span>
            <span class="token operator">+</span> <span class="token string">&quot;&amp;&amp; args(trackNumber)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">trackPlayed</span><span class="token punctuation">(</span><span class="token keyword">int</span> trackNumber<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;trackPlayed(trackNumber)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">countTrack</span><span class="token punctuation">(</span><span class="token keyword">int</span> trackNumber<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> currentCount <span class="token operator">=</span> <span class="token function">getPlayCount</span><span class="token punctuation">(</span>trackNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
        trackCounts<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>trackNumber<span class="token punctuation">,</span> currentCount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getPlayCount</span><span class="token punctuation">(</span><span class="token keyword">int</span> trackNumber<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> trackCounts<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>trackNumber<span class="token punctuation">)</span>
                <span class="token operator">?</span> trackCounts<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>trackNumber<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>포인트커트 표현식에서 args(trackNumber) 식별자는 playTrack()에 전달되는 int인자는 어드바이스로 전달됨을 나타낸다.<br>
파라미터 명 trackNumber는 포인트커트 메소드 시그너쳐(signature)의 파라미터와도 매칭된다.<br>
@Before 애너테이션은 명명된 포인트커트, 즉 trackPlayed(trackNumber)로 정의되어 있는 어드바이스 메소드로 전달된다.<br>
포인트커트 파라미터는 명명 포인트커트에서 어드바이스 메소드까지의 파라미터의 경로를 제공하는 포인트커트 메소드의 동일 명의 파라미터와 연관된다.</p> <p>스프링 설정에서 빈을 등록하고 AspectJ 오토 프록싱(auto-proxing)을 사용한다.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableAspectJAutoProxy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TrackCounterConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CD</span> <span class="token function">sgtPeppers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BlankCD</span> cd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BlankCD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cd<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Sgt. Pepper's Lonely Hearts Club Band!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cd<span class="token punctuation">.</span><span class="token function">setArtist</span><span class="token punctuation">(</span><span class="token string">&quot;The Beatles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tracks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tracks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Sgt. Pepper's Lonely Hearts Club Band&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tracks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;With a Little Help from My Friends&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tracks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Lucy in the Sky with Diamonds&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tracks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Getting Better&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tracks<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Fixing a Hole&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        cd<span class="token punctuation">.</span><span class="token function">setTracks</span><span class="token punctuation">(</span>tracks<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cd<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TrackCounter</span> <span class="token function">trackCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TrackCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sunny-archive/springFramework/springInAction/Chapter03.html" class="prev">
        Chapter03# 고급와이어링
      </a></span> <span class="next"><a href="/sunny-archive/springFramework/springInAction/Chapter05.html">
        Chapter05# Spring Web Application
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/sunny-archive/assets/js/app.20f77d52.js" defer></script><script src="/sunny-archive/assets/js/2.511b4fc5.js" defer></script><script src="/sunny-archive/assets/js/22.085befa6.js" defer></script>
  </body>
</html>
