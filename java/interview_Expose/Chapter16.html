<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter16 스프링 프레임워크 | Sunny Archive</title>
    <meta name="description" content="개발 관련 블로그">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/sunny-archive/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons">
    
    <link rel="preload" href="/sunny-archive/assets/css/0.styles.a7ac78a8.css" as="style"><link rel="preload" href="/sunny-archive/assets/js/app.20f77d52.js" as="script"><link rel="preload" href="/sunny-archive/assets/js/2.511b4fc5.js" as="script"><link rel="preload" href="/sunny-archive/assets/js/15.54027cd4.js" as="script"><link rel="prefetch" href="/sunny-archive/assets/js/10.a0ef1271.js"><link rel="prefetch" href="/sunny-archive/assets/js/11.6541ddd8.js"><link rel="prefetch" href="/sunny-archive/assets/js/12.1903e15c.js"><link rel="prefetch" href="/sunny-archive/assets/js/13.197863a7.js"><link rel="prefetch" href="/sunny-archive/assets/js/14.9b068972.js"><link rel="prefetch" href="/sunny-archive/assets/js/16.524f5d92.js"><link rel="prefetch" href="/sunny-archive/assets/js/17.11708487.js"><link rel="prefetch" href="/sunny-archive/assets/js/18.5d867f86.js"><link rel="prefetch" href="/sunny-archive/assets/js/19.0f648627.js"><link rel="prefetch" href="/sunny-archive/assets/js/20.27ef1d38.js"><link rel="prefetch" href="/sunny-archive/assets/js/21.77345df6.js"><link rel="prefetch" href="/sunny-archive/assets/js/22.085befa6.js"><link rel="prefetch" href="/sunny-archive/assets/js/23.8490966f.js"><link rel="prefetch" href="/sunny-archive/assets/js/24.ec8405cd.js"><link rel="prefetch" href="/sunny-archive/assets/js/25.b0db359b.js"><link rel="prefetch" href="/sunny-archive/assets/js/26.46aa84cd.js"><link rel="prefetch" href="/sunny-archive/assets/js/27.8c499cc1.js"><link rel="prefetch" href="/sunny-archive/assets/js/28.a0f23262.js"><link rel="prefetch" href="/sunny-archive/assets/js/3.6c4817b1.js"><link rel="prefetch" href="/sunny-archive/assets/js/4.360058bb.js"><link rel="prefetch" href="/sunny-archive/assets/js/5.c75d34e9.js"><link rel="prefetch" href="/sunny-archive/assets/js/6.7ef6ecd2.js"><link rel="prefetch" href="/sunny-archive/assets/js/7.e7a5c462.js"><link rel="prefetch" href="/sunny-archive/assets/js/8.07adb725.js"><link rel="prefetch" href="/sunny-archive/assets/js/9.026c5ddc.js">
    <link rel="stylesheet" href="/sunny-archive/assets/css/0.styles.a7ac78a8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/sunny-archive/" class="home-link router-link-active"><!----> <span class="site-name">Sunny Archive</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/youngsunWoo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/youngsunWoo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/sunny-archive/" class="sidebar-heading clickable router-link-active open"><span>책읽기</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>JAVA</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading open"><span>JAVA 프로그래밍 면접 이렇게 준비한다</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sunny-archive/java/interview_Expose/Chapter06.html" class="sidebar-link">Chapter06# 디자인패턴</a></li><li><a href="/sunny-archive/java/interview_Expose/Chapter08.html" class="sidebar-link">Chapter08# 자바기본(1)</a></li><li><a href="/sunny-archive/java/interview_Expose/Chapter10.html" class="sidebar-link">Chapter10# 자바가상머신(JVM)이해하기</a></li><li><a href="/sunny-archive/java/interview_Expose/Chapter14.html" class="sidebar-link">Chapter14# HTTP</a></li><li><a href="/sunny-archive/java/interview_Expose/Chapter16.html" class="active sidebar-link">Chapter16# 스프링 프레임워크</a></li><li><a href="/sunny-archive/java/interview_Expose/Chapter17.html" class="sidebar-link">Chapter17# 하이버네이트 사용하기</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>스프링 인 액션</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="chapter16-스프링-프레임워크"><a href="#chapter16-스프링-프레임워크" class="header-anchor">#</a> Chapter16 스프링 프레임워크</h1> <p></p><div class="table-of-contents"><ul><li><a href="#스프링-핵심기능과-어플리케이션-컨택스트">스프링 핵심기능과 어플리케이션 컨택스트</a></li><li><a href="#스프링-jdbc">스프링 JDBC</a></li><li><a href="#통합테스트하기">통합테스트하기</a></li><li><a href="#스프링mvc">스프링MVC</a></li></ul></div><p></p> <h2 id="스프링-핵심기능과-어플리케이션-컨택스트"><a href="#스프링-핵심기능과-어플리케이션-컨택스트" class="header-anchor">#</a> 스프링 핵심기능과 어플리케이션 컨택스트</h2> <h4 id="q1-스프링에서-의존성-주입을-어떻게-하는가"><a href="#q1-스프링에서-의존성-주입을-어떻게-하는가" class="header-anchor">#</a> <code>Q1. 스프링에서 의존성 주입을 어떻게 하는가?</code></h4> <ul><li>의존성 주입은 스프링의 핵심기능중 하나로 다른 클래스나 서브파티 인터페이스가 있는 클래스의 의존성을 제거 할 수 있게 해준다.</li> <li>의존성 주입의 장점은 의존성의 구현을 클래스 내부 소스 변경없이 바꿀수 있다는 것이다.</li></ul> <p>(sampleCode) 철자를 체크하는 어플리게이션 예제</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpellCheckApplication</span> <span class="token punctuation">{</span>
 	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Dictionary</span> dictionary<span class="token punctuation">;</span>
 	<span class="token keyword">public</span> <span class="token class-name">SpellCheckApplication</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Dictionary</span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">this</span><span class="token punctuation">.</span>dictionary <span class="token operator">=</span> dictionary<span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>

 	<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">checkDocument</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> document<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> misspelledWords <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> document<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 			<span class="token keyword">final</span> <span class="token class-name">String</span> word <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
 			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dictionary<span class="token punctuation">.</span><span class="token function">validWord</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 				misspelledWords<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
 			<span class="token punctuation">}</span>
 		<span class="token punctuation">}</span>
 		<span class="token keyword">return</span> misspelledWords<span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>SpellCheckApplication Dictionary에 의존적이다.<br>
철차를 체크하기 위해 validWord 함수를 호출하며 실제로 어떻게 처리되는지 할 수 없다 .
SpellCheckApplication이 실제로 실행될때 설정해야한다.</p></li> <li><p>테스트를 위해 Dictionary 인터페이스를 구현할 필요는 없으면 mock을 사용해 생성할 수 있다.</p></li></ul> <p>(sampleCode) 철자를 체커를 실행하는 클래스</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpellCheckRunner</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Usage java SpellCheckRunner &lt;file_to_check&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">final</span> <span class="token class-name">Dictionary</span> dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileDictionary</span><span class="token punctuation">(</span><span class="token string">&quot;/usr/share/dict/words&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">final</span> <span class="token class-name">SpellCheckApplication</span> checker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpellCheckApplication</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> wordsFromFile <span class="token operator">=</span> <span class="token function">getWordsFromFile</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> indices <span class="token operator">=</span> checker<span class="token punctuation">.</span><span class="token function">checkDocument</span><span class="token punctuation">(</span>wordsFromFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">if</span> <span class="token punctuation">(</span>indices<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No spelling errors!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;The following words were spelled incorrectly:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Integer</span> index <span class="token operator">:</span> indices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>wordsFromFile<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

 	<span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getWordsFromFile</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> filename<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 		<span class="token comment">/* omitted */</span>
 	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>FileDictionary 클래스 명시는 문제되지 않으며 이 클래스를 통해 생성자가 파일 경로 String을 인자로 받는다.</li> <li>위 구현은 파일 위치가 변경되거나 서드파티의 사전을 사용하는 경우 변경이 필요하다.</li> <li>따라서 직접 객체를 생성해 주입하기 보다는 프레임워크를 사용하여 의존성을 주입받아 이를 해결해보자</li></ul> <p>(sampleCode) XML을 이용한 스프링 어플리케이션 컨택스트 정의</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
 	<span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
 	<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span> http://www.springframework.org/schema/beans
 	http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dictionary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.wiley.javainterviewsexposed.chapter16.FileDictionary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/usr/share/dict/words<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>spellChecker<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.wiley.javainterviewsexposed.chapter16.SpellCheckApplication<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dictionary<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>위 xml파일은 dictionary와 spellChecker 두개의 빈을 정의하며 생성자용 값도 제공한다.</li> <li>constructor-arg 태그로 string 값을 받아 생성자에 값을 넣어줄수 있다.</li> <li>property 태그를 사용해 setter속성 정의도 가능하다.</li> <li><property name="location" value="London"></property>는 setLocation(&quot;London&quot;)과 같은 역할을 한다. 메소드가 없으면 오류가 나며 실행전까지 알 수가 없다.</li> <li>spellChecker빈은 constructor-arg 의 ref 속성을 이용하여 dictionary 빈을 생성자로 받는다.</li></ul> <h4 id="q2-자바-코드에서-어플리케이션-컨택스트를-어떻게-정의-하는가"><a href="#q2-자바-코드에서-어플리케이션-컨택스트를-어떻게-정의-하는가" class="header-anchor">#</a> <code>Q2. 자바 코드에서 어플리케이션 컨택스트를 어떻게 정의 하는가?</code></h4> <ul><li>스프링 3.0 에서 도입된 어플리케이션 컨택스트를 통해 설정에서 클래스 패스를 찾을수 있다.</li> <li>@Configuration 어노테이션이 있는 클래스 내부의 @Bean 어노테이션이 붙은 메소드을 Bean으로 만들어준다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringJavaConfiguration</span> <span class="token punctuation">{</span>
 	<span class="token annotation punctuation">@Bean</span>
 	<span class="token keyword">public</span> <span class="token class-name">Dictionary</span> <span class="token function">dictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
 		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FileDictionary</span><span class="token punctuation">(</span><span class="token string">&quot;/usr/sunny/documents/words&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>
 	<span class="token annotation punctuation">@Bean</span>
 	<span class="token keyword">public</span> <span class="token class-name">SpellCheckApplication</span> <span class="token function">spellCheckApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
 		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SpellCheckApplication</span><span class="token punctuation">(</span><span class="token function">dictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>@Configuration 어노테이션이 있는 클래스의 리스트를 받도록 AnnotationConfigApplicationContext 클래스로 어플리케이션을 초기화한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">ApplicationContext</span> context <span class="token operator">=</span>
 <span class="token keyword">new</span> <span class="token class-name">AnnotationConfigApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">SpringJavaConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.sunny.javainterviewsexposed.chapter16<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><h4 id="q3-스코프란-무엇인가"><a href="#q3-스코프란-무엇인가" class="header-anchor">#</a> <code>Q3. 스코프란 무엇인가</code></h4> <ul><li>기본적으로 스프링의 빈의 인스턴드는 1개만 생성된다 -&gt; 즉 싱글턴스코프이다.</li> <li>스코프 종류</li></ul> <div class="language- extra-class"><pre class="language-text"><code>- singleton : 기본 싱글톤 스코프
- prototype : 어플리케이션에서 요청시 (getBean()) 마다 스프링이 새 인스턴스를 생성
- session : HTTP 세션별로 인스턴스화되며 세션이 끝나며 소멸 (spring mvc webapplication 용도)
- request : HTTP 요청별로 인스턴스화 되며 요청이 끝나면 소멸 (spring mvc webapplication 용도)
- global session : 포틀릿 기반의 웹 어플리케이션 용도. 전역 세션 스코프의 빈은 같은 스프링 MVC를 사용한 포탈 어플리케이션 내의 모든 포틀릿 사이에서 공유할 수 있다
- thred : 새 스레드에서 요청하면 새로운 bean 인스턴스를 생성, 같은 스레드에 대해서는 항상 같은 bean 인스턴스가 반환
- custom : org.pringframework.beans.factory.config.Scope를 구현하고 커스텀 스코프를 스프링의 설정에 등록하여 사용
</code></pre></div><h4 id="q4-환경별-속성을-관리-하려면-어떻게-설정해야-하는가"><a href="#q4-환경별-속성을-관리-하려면-어떻게-설정해야-하는가" class="header-anchor">#</a> <code>Q4. 환경별 속성을 관리 하려면 어떻게 설정해야 하는가?</code></h4> <ul><li>PropertyPlaceholderCongigurer 클래스는 빌드할때 외부에 속성을 설정할수 있도록 한다.</li> <li>테스트를 위해 각 환경별로 파일을 만들기보다는 환경별 설정을 통해 제어도록 하자.</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.beans.factory.configPropertyPlaceholderConfigurer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>location<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/com/sunny/javainterviewsexposed/chapter16/environment.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>placeholderPrefix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$property{<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>placeholderSuffix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.wiley.javainterviewsexposed.chapter16.ServerSetup<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>$property{server.hostname}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>PropertyPlaceholderCongigurer의 location속성을 통해 파일을 설정하고 클래스에는 해당 파일에서 속성값들을 분석한다.</li> <li>어플리케이션을 실행할때 파싱되어 다른 빈의 매개변수로 사용 될 수 있다.</li></ul> <h4 id="q5-오토와이어링이란-무엇인가"><a href="#q5-오토와이어링이란-무엇인가" class="header-anchor">#</a> <code>Q5. 오토와이어링이란 무엇인가?</code></h4> <p>(1) XML이용</p> <ul><li>xml을 통한 오토와이어링 설정</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dictionary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.sunny.javainterviewsexposed.chapter16.FileDictionary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/usr/share/dict/words<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>spellChecker<span class="token punctuation">&quot;</span></span>
 	<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.sunny.javainterviewsexposed.chapter16.SpellCheckApplication<span class="token punctuation">&quot;</span></span>
 	<span class="token attr-name">autowire</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>constructor<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><ul><li>오토와이어링 테스트</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getAutowiredBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 	<span class="token keyword">final</span> <span class="token class-name">ApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span>
 				<span class="token string">&quot;com/sunny/javainterviewsexposed/&quot;</span> <span class="token operator">+</span>
 				<span class="token string">&quot;chapter16/applicationContextAutowiring.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	 <span class="token keyword">final</span> <span class="token class-name">SpellCheckApplication</span> bean <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">SpellCheckApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">assertNotNull</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>위 xml설정은 어플리케이션 컨택스트에 SpellCheckApplication의 생성자로 쓰일 데이터 타입인 Dictionary 타입 클래스를 찾도록 한다.</li> <li>컨택스트에 Dictionary 타입의 구현체가 없으면 NoSuchBeanDefinitionException이 발생한다.</li></ul> <p>(2) Autowired 어노테이션 이용</p> <ul><li>@Autowired 통한 생성자에 오토와이어링 설정</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">public</span> <span class="token class-name">SpellCheckApplication</span> <span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Dictionary</span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 	<span class="token keyword">this</span><span class="token punctuation">.</span>dictionary <span class="token operator">=</span> dictionary<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>컨택스트가 같은 타입의 빈을 여러개 가지고 있다면 @Qualifier를 통해 빈을 구체화 할 수 있다.</li></ul> <p><strong>(참고) Autowired과 @Resource 차이</strong></p> <h4 id="autowired-스프링이-타입-class-을-우선으로-bean-객체를-검색"><a href="#autowired-스프링이-타입-class-을-우선으로-bean-객체를-검색" class="header-anchor">#</a> @Autowired : 스프링이 타입(class)을 우선으로 bean 객체를 검색</h4> <blockquote><ul><li>BinarySearchImpl은 SortAlgorithm 을 depends on 한다.</li> <li>SortAlgorithm은 BinarySearchImpl의 dependency다.</li> <li>autowiring 의 bean 선택은 3가지 (우선순위순)</li> <li>@Qualifier</li> <li>@Primary</li> <li>변수명을 dependency 빈 이름으로 (ex private SortAlgorithm bubbleSortAlgorithm)</li></ul></blockquote> <h4 id="resource-스프링이-이름-id-을-우선으로-bean-객체를-검색"><a href="#resource-스프링이-이름-id-을-우선으로-bean-객체를-검색" class="header-anchor">#</a> @Resource : 스프링이 이름(id)을 우선으로 bean 객체를 검색</h4> <blockquote><ul><li>resourcing 의 bean 선택</li> <li>지정한 name과 id가 같은 bean 객체</li> <li>타입이 같은 bean 객체</li> <li>만약 타입이 같은 bean 객체가 2개 이상이면, 변수명과 id가 같은 bean 객체</li> <li>@Qualifier가 지정한 bean 객체</li></ul></blockquote> <hr> <h2 id="스프링-jdbc"><a href="#스프링-jdbc" class="header-anchor">#</a> 스프링 JDBC</h2> <h4 id="q1-스프링은-어떻게-jdbc-코드의-가독성을-개선하는가"><a href="#q1-스프링은-어떻게-jdbc-코드의-가독성을-개선하는가" class="header-anchor">#</a> <code>Q1. 스프링은 어떻게 JDBC 코드의 가독성을 개선하는가?</code></h4> <ul><li>기본 JDK API를 이용한 DB Connection</li> <li>데이터베이스에 접근하기 위해 Connection, Prepared Statement, ResultSet같은 클래스들의 생성,사용,파기를 관리해아 한다.</li> <li>특히 파기 과정에서 SQLException이 발생하는 경우 DB커넥션이 계속 살아있는 경우가 발생한다.</li> <li>또한, try에서 초기화되고 finally 블록에서 닫히므로 final로 선언 될 수 없어 재할당에 대한 위험도 존재한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">plainJdbcExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
 	<span class="token class-name">PreparedStatement</span> insert <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
 	<span class="token class-name">PreparedStatement</span> query <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
 	<span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
 	<span class="token keyword">try</span> <span class="token punctuation">{</span>
 		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;com.mysql.jdbc.Driver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>
 				<span class="token string">&quot;jdbc:mysql://localhost:3306/springtrans?&quot;</span> <span class="token operator">+</span>
 				<span class="token string">&quot;user=nm&amp;&quot;</span> <span class="token operator">+</span>
 				<span class="token string">&quot;password=password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		insert <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;insert into user values (?, ?)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;Dave&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Erica&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Frankie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> user <span class="token operator">:</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 			insert<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			insert<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
 			insert<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		<span class="token punctuation">}</span>
 		query <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;select count(*) from user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 		resultSet <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to retrieve row count of user table&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
			<span class="token keyword">final</span> <span class="token keyword">int</span> rowCount <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">assertTrue</span><span class="token punctuation">(</span>rowCount <span class="token operator">&gt;=</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> <span class="token operator">|</span> <span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">&quot;Exception occurred in database access: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
			<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				query<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>insert <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				insert<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to close Database connection: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>스프링에서는 Jdbcutils클래스를 통해 다양한 기능을 제공한다.]</li> <li>-&gt; close할때의 예외상황을 보다 간결하게 관리할 수 있다.</li> <li>-&gt; ResultSet에서 결과를 가져도록 지원한다.</li> <li>-&gt; snake_case를 camelCase로 변환하는 함수도 지원한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token comment">// 위와 동일</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> <span class="token operator">|</span> <span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 위와 동일</span>
	<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
		<span class="token class-name">JdbcUtils</span><span class="token punctuation">.</span><span class="token function">closeResultSet</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">JdbcUtils</span><span class="token punctuation">.</span><span class="token function">closeStatement</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">JdbcUtils</span><span class="token punctuation">.</span><span class="token function">closeStatement</span><span class="token punctuation">(</span>insert<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">JdbcUtils</span><span class="token punctuation">.</span><span class="token function">closeConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>(tip) 자바 8에서 도입된 try-with-resource문을 사용시 코드를 더 간결하게 사용가능하다.</p> <h4 id="q2-스프링은-기본-jdbc코드-대부분을-어떻게-제거할-수-있는가"><a href="#q2-스프링은-기본-jdbc코드-대부분을-어떻게-제거할-수-있는가" class="header-anchor">#</a> <code>Q2. 스프링은 기본 JDBC코드 대부분을 어떻게 제거할 수 있는가?</code></h4> <ul><li><p>JdcbTemplate클래스를 사용한다.</p></li> <li><p>xml로 어플리케이션 컨택스트에 DB설정하기</p></li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource.DriverManagerDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306/springtest<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sunny<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jdbcTemplate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.core.JdbcTemplate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>JDCB Tamplate 이용하기</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:com/sunny/javainterviewsexposed /chapter16/jdbcTemplateContext.xml&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcTemplateUsage</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Autowired</span>
	<span class="token keyword">private</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">retrieveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">final</span> <span class="token keyword">int</span> rowCount <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForInt</span><span class="token punctuation">(</span><span class="token string">&quot;select count(*) from user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span>
			jdbcTemplate<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
				<span class="token string">&quot;select id, username from user&quot;</span><span class="token punctuation">,</span>
				<span class="token keyword">new</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token annotation punctuation">@Override</span>
					<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">mapRow</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token keyword">int</span> rowNum<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
						<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//람다로 처리하기</span>
		<span class="token comment">//jdbcTemplate.query(queryString, (rs, rowNum) -&gt; {</span>
 		<span class="token comment">//	return new User(rs.getString(“id”), rs.getString(“username”));</span>
		<span class="token comment">//});</span>

		<span class="token function">assertEquals</span><span class="token punctuation">(</span>rowCount<span class="token punctuation">,</span> userList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>위 코드는 데이터베이스에 2번 접근한다.</li> <li>(1) queryForInt메서드느 하나의 행과 열을 반환하기 위해 쿼리를 수행하고 int형을 변환될수 잇는 숫자타입을 반환한다.<br>
RequltSet객체에 대한 고민이 필요없다 .</li> <li>(2) jdbcTemplate.query 함수는 DB의 각 행이 User객체로 변환된다.<br>
각 행이 어떻게 변환되는지는 모르며 rowMapper인터페이스를 익명구현하여 DB각 행마다 mapRow메서드가 호출된다.</li> <li>결과적으로 데이터베이스 연결이나 데이터베이스 자원 객체를 직적 관리할 필요없으며, 쿼리 실행 후 자원을 해제할 필요도 없다.</li></ul> <hr> <h2 id="통합테스트하기"><a href="#통합테스트하기" class="header-anchor">#</a> 통합테스트하기</h2> <h4 id="q1-어플리케이션-컨택스트가-올바르게-설정됐는지-어떻게-테스트-할-수-있는가"><a href="#q1-어플리케이션-컨택스트가-올바르게-설정됐는지-어떻게-테스트-할-수-있는가" class="header-anchor">#</a> <code>Q1. 어플리케이션 컨택스트가 올바르게 설정됐는지 어떻게 테스트 할 수 있는가?</code></h4> <ul><li><p>@ContextConfiguration어노테이션을 사용하여 로드될 어플리케이션 컨택스트를 설정할 수 있다.</p></li> <li><p>@Autuwired된 빈들은 테스트 실행시마다 어플리케이션 컨택스트에서 새로 로드된다.</p></li> <li><p>즉, @Before를 통해 테스트 실행정 어노테이션되는 것과 동일하다.</p></li> <li><p>테스트가 어플리케이션 컨택스트 상태를 변경해야 하는 경우 해당 클래스에 @FirtiesContext어노테이션을 추가하면,<br>
테스트마다 전체 어플리케이션 컨택스트를 다시 로드한다.</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>
 <span class="token string">&quot;classpath:com/sunny/javainterviewsexposed/chapter16/applicationContext.xml&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringIntegrationTest</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Autowired</span>
	<span class="token keyword">private</span> <span class="token class-name">SpellCheckApplication</span> application<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkWiring</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">assertNotNull</span><span class="token punctuation">(</span>application<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">useSpringIntegrationTests</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> words <span class="token operator">=</span>
		<span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;correct&quot;</span><span class="token punctuation">,</span>
					<span class="token string">&quot;valid&quot;</span><span class="token punctuation">,</span>
					<span class="token string">&quot;dfgluharg&quot;</span><span class="token punctuation">,</span>
					<span class="token string">&quot;acceptable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> expectedInvalidIndices <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> actualInvalidIndices <span class="token operator">=</span>
		application<span class="token punctuation">.</span><span class="token function">checkDocument</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">assertEquals</span><span class="token punctuation">(</span>expectedInvalidIndices<span class="token punctuation">,</span> actualInvalidIndices<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="q2-통합테스트를-실행할-때-데이터베이스를-깨끗하게-유지하는-방법은-무엇인가"><a href="#q2-통합테스트를-실행할-때-데이터베이스를-깨끗하게-유지하는-방법은-무엇인가" class="header-anchor">#</a> <code>Q2. 통합테스트를 실행할 때 데이터베이스를 깨끗하게 유지하는 방법은 무엇인가</code></h4> <ul><li>@Before가 실행되기 전에 트랜젝션이 열린다. 테스트가 실행되고 @After까지 실행되면 데이터가 롤백된다.</li> <li>@Test 메서드 안에서 (명시적으로) commit이 되지 않는지 확인한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span> <span class="token string">&quot;classpath:com/sunny/javainterviewsexposed/&quot;</span> <span class="token operator">+</span>
						 <span class="token string">&quot;chapter16/databaseTestApplicationContext.xml&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDatabaseTransactionTest</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractTransactionalJUnit4SpringContextTests</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">int</span> rowCount<span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Before</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkRowsInTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>rowCount <span class="token operator">=</span> <span class="token function">countRowsInTable</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Before</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">checkUsersForTestDoNotExist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">final</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>simpleJdbcTemplate<span class="token punctuation">.</span><span class="token function">queryForInt</span><span class="token punctuation">(</span>
		<span class="token string">&quot;select count(*) from user where username in (?, ?, ?)&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;Charlie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">assertEquals</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">runInTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> users <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>
		<span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Alice&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Charlie&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token punctuation">.</span>simpleJdbcTemplate<span class="token punctuation">.</span><span class="token function">batchUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;insert into user values (?, ?)&quot;</span><span class="token punctuation">,</span> users<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">assertEquals</span><span class="token punctuation">(</span>rowCount <span class="token operator">+</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">countRowsInTable</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>JUnut 4.11에서는 @Test메서드의 실행순서를 정해줄 수 있는 @FixMethodOrder 어노테이션을 제공한다.</li> <li>위 코드처럼 트랜젝션이 롤백되고 테이블이 비었는지 확인하는 코드를 작성하고 runInTransaction 다음에 실행되도록 할 수 있다.</li> <li>테스트 순서를 명시하는건 좋지않다. 왜냐면 각 테스트는 독릭접으로 수행되어야하니까..</li></ul> <ul><li>AbstractTransactionalJUnit4SpringContextTests를 확장하고 DataSource와 함께 어플리케이션 컨택스트를 제공</li> <li>테스트 set는 SimpleJdbcTemplate 객체에 접근하고 DB연산을 수행한다.</li></ul> <hr> <h2 id="스프링mvc"><a href="#스프링mvc" class="header-anchor">#</a> 스프링MVC</h2> <p><a href="/sunny-archive/java/spring&amp;web/springInAction/Chapter5#SpringMVC시작하기.html">(참고) Spring in Action &gt; Chapter5# Spring MVC 시작하기</a></p> <h4 id="q1-스프링은-어떻게-웹-어플리케이션을-제공하는가"><a href="#q1-스프링은-어떻게-웹-어플리케이션을-제공하는가" class="header-anchor">#</a> <code>Q1. 스프링은 어떻게 웹 어플리케이션을 제공하는가?</code></h4> <ul><li><p>어플리케이션 서버를 실행하면 스프링 MVC는 클래스패스/META-INF 패키지에서 web.xml 파일을 찾는다.</p></li> <li><p>이 파일은 서버가 어떤 어플리케이션이나 서블릿을 제공할지 명시한다.</p></li> <li><p>즉, HttpSevlet을 확장하는 클래스를 제공하고 GET/POST에 어떻게 응답할지 정의한다.</p></li> <li><p>스프링 MVC용 서블릿 컨테이너 설정</p></li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span>
	<span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>
	http://java.sun.com/xml/ns/javaee
	http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name">metadata-complete</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>3.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>mvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>mvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/mvc/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>/mvc로 시작하는 모든 요청을 DispatcherServlet에 전달한다.</li> <li>DispatcherServlet에 요청이 전달되면 WEB-INF/[servlet-name]-servlet.xml 에서 XML 정의를 찾는다.</li> <li>해당 xml에서 빈을 설정할수 있으며 서버가 실행될때 빈들이 초기화 된다.</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>p</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/p<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>
	http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
	http://www.springframework.org/schema/context
	http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.sunny.javainterviewsexposed.chapter16.mvc<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>freemarkerConfig<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>templateLoaderPath<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/WEB-INF/freemarker/<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewResolver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>prefix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>suffix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>.ftl<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.wiley.javainterviewsexposed.chapter16.mvc.DummySportsResultsService<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>context:component-scan을 통해 @Controller 어노테이션된 클래스를 찾을 패키지를 알려준다.</li></ul> <blockquote><p>근데.. xml하지말고.. 스프링 3.0쓰고 자바로 설정하자..<br>
AbstractAnnotationConfigDispatcherServletInitializer 상속받자..
<a href="/sunny-archive/java/spring&amp;web/springInAction/Chapter5#SpringMVC시작하기.html">(참고) Spring in Action &gt; Chapter5# Spring MVC 시작하기</a> &lt;-이거 보자..</p></blockquote> <h4 id="q2-어떻게-스프링-mvc에서-쉽게-테스트-할-수-있는-웹-컨트롤러를-만들-수-있는가"><a href="#q2-어떻게-스프링-mvc에서-쉽게-테스트-할-수-있는-웹-컨트롤러를-만들-수-있는가" class="header-anchor">#</a> <code>Q2. 어떻게 스프링 MVC에서 쉽게 테스트 할 수 있는 웹 컨트롤러를 만들 수 있는가?</code></h4> <h4 id="q3-서버-측-로직을-요쳥-결과-표시와-어떻게-분리해서-유지하는가"><a href="#q3-서버-측-로직을-요쳥-결과-표시와-어떻게-분리해서-유지하는가" class="header-anchor">#</a> <code>Q3. 서버 측 로직을 요쳥 결과 표시와 어떻게 분리해서 유지하는가?</code></h4> <ul><li><p>뷰는 컨트롤러를 통해 전달받은 모델을 보여준다.</p></li> <li><p>뷰는 단순해야하고 컨트롤러는 모델을 전달하기 위한 작업을 수행해야 한다.</p></li> <li><p>뷰에서 플레이스 홀더를 이용하여 동적데이터를 표현할 수 있다. (?)</p></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/planets&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">createSimpleModel</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;now&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> diameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	diameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Mercury&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3000 miles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	diameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Venus&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7500 miles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	diameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;Earth&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;8000 miles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;diameters&quot;</span><span class="token punctuation">,</span> diameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token string">&quot;diameters&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Planet Diameters<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">diameters?keys</span> <span class="token attr-name">as</span> <span class="token attr-name">planet</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>${planet}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>: ${diameters[planet]}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
	This page was generated on <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span><span class="token punctuation">&gt;</span></span>${now?datetime}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h4 id="q4-스프링은-다른-뷰-템플릿-엔진들과-함께-동작하도록-어떻게-설정할-수-있는가"><a href="#q4-스프링은-다른-뷰-템플릿-엔진들과-함께-동작하도록-어떻게-설정할-수-있는가" class="header-anchor">#</a> <code>Q4. 스프링은 다른 뷰 템플릿 엔진들과 함께 동작하도록 어떻게 설정할 수 있는가?</code></h4> <p>템플릿파일로 매핑은 어플리케이션 설정에서 뷰리졸버의 구현에 의존된다.
원래의(기본) 뷰 리졸버는 아래와 같다.</p> <ul><li>xml로 설정</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewResolver<span class="token punctuation">&quot;</span></span>
 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>prefix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>suffix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>.ftl<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>(참고) java기반 뷰 리졸버 설정</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebMvc</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span><span class="token string">&quot;spittr.web&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebMvcConfigurerAdapter</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Bean</span>
  <span class="token keyword">public</span> <span class="token class-name">ViewResolver</span> <span class="token function">viewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//&lt;-뷰리졸버 설정</span>
    <span class="token class-name">InternalResourceViewResolver</span> resolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InternalResourceViewResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    resolver<span class="token punctuation">.</span><span class="token function">setPrefix</span><span class="token punctuation">(</span><span class="token string">&quot;/WEB-INF/views/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    resolver<span class="token punctuation">.</span><span class="token function">setSuffix</span><span class="token punctuation">(</span><span class="token string">&quot;.jsp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resolver<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><ul><li>위 코드를 통해서 지정된 경로에서 prefix, suffix를 가지는 파일을 템플릿으로 찾아온다.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sunny-archive/java/interview_Expose/Chapter14.html" class="prev">
        Chapter14# HTTP
      </a></span> <span class="next"><a href="/sunny-archive/java/interview_Expose/Chapter17.html">
        Chapter17# 하이버네이트 사용하기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/sunny-archive/assets/js/app.20f77d52.js" defer></script><script src="/sunny-archive/assets/js/2.511b4fc5.js" defer></script><script src="/sunny-archive/assets/js/15.54027cd4.js" defer></script>
  </body>
</html>
